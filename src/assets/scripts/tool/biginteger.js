(function(t){"use strict";var e={};function r(t,n,s){if(s!==e)return t instanceof r?t:void 0===t?i:r.parse(t);for(t=t||[];t.length&&!t[t.length-1];)--t.length;this._d=t,this._s=t.length?n||1:0}r._construct=function(t,n){return new r(t,n,e)};var n=1e7;r.base=n,r.base_log10=7;var i=new r([],0,e);r.ZERO=i;var s=new r([1],1,e);r.ONE=s;var o=new r(s._d,-1,e);r.M_ONE=o,r._0=i,r._1=s,r.small=[i,s,new r([2],1,e),new r([3],1,e),new r([4],1,e),new r([5],1,e),new r([6],1,e),new r([7],1,e),new r([8],1,e),new r([9],1,e),new r([10],1,e),new r([11],1,e),new r([12],1,e),new r([13],1,e),new r([14],1,e),new r([15],1,e),new r([16],1,e),new r([17],1,e),new r([18],1,e),new r([19],1,e),new r([20],1,e),new r([21],1,e),new r([22],1,e),new r([23],1,e),new r([24],1,e),new r([25],1,e),new r([26],1,e),new r([27],1,e),new r([28],1,e),new r([29],1,e),new r([30],1,e),new r([31],1,e),new r([32],1,e),new r([33],1,e),new r([34],1,e),new r([35],1,e),new r([36],1,e)],r.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r.prototype.toString=function(t){if((t=+t||10)<2||t>36)throw new Error("illegal radix "+t+".");if(0===this._s)return"0";if(10===t){var e=this._s<0?"-":"";e+=this._d[this._d.length-1].toString();for(var n=this._d.length-2;n>=0;n--){for(var i=this._d[n].toString();i.length<7;)i="0"+i;e+=i}return e}var s=r.digits;t=r.small[t];for(var o,a=this._s,h=this.abs(),u=[];0!==h._s;){var f=h.divRem(t);h=f[0],o=f[1],u.push(s[o.valueOf()])}return(a<0?"-":"")+u.reverse().join("")},r.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/],r.parse=function(t,n){var s;t=t.toString(),void 0!==n&&10!=+n||(t=function(t){return(t=t.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e")).replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(t,e,r,n,i){var s=(i=+i)<0,o=r.length+i;t=(s?r:n).length,i=(i=Math.abs(i))>=t?i-t+s:0;var a=new Array(i+1).join("0"),h=r+n;return(e||"")+(s?h=a+h:h+=a).substr(0,o+=s?a.length:0)+(o<h.length?"."+h.substr(o):"")})}(t)),s=void 0===n?"0[xcb]":16==n?"0x":8==n?"0c":2==n?"0b":"";var o=new RegExp("^([+\\-]?)("+s+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(t);if(o){var a=o[1]||"+",h=o[2]||"",u=o[3]||"";if(void 0===n)n="0x"===h||"0X"===h?16:"0c"===h||"0C"===h?8:"0b"===h||"0B"===h?2:10;else if(n<2||n>36)throw new Error("Illegal radix "+n+".");if(n=+n,!r.radixRegex[n].test(u))throw new Error("Bad digit for radix "+n);if(0===(u=u.replace(/^0+/,"").split("")).length)return i;if(a="-"===a?-1:1,10==n){for(var f=[];u.length>=7;)f.push(parseInt(u.splice(u.length-r.base_log10,r.base_log10).join(""),10));return f.push(parseInt(u.join(""),10)),new r(f,a,e)}f=i;n=r.small[n];for(var l=r.small,_=0;_<u.length;_++)f=f.multiply(n).add(l[parseInt(u[_],36)]);return new r(f._d,a,e)}throw new Error("Invalid BigInteger format: "+t)},r.prototype.add=function(t){if(0===this._s)return r(t);if(0===(t=r(t))._s)return this;if(this._s!==t._s)return t=t.negate(),this.subtract(t);for(var i,s=this._d,o=t._d,a=s.length,h=o.length,u=new Array(Math.max(a,h)+1),f=Math.min(a,h),l=0,_=0;_<f;_++)i=s[_]+o[_]+l,u[_]=i%n,l=i/n|0;for(h>a&&(s=o,a=h),_=f;l&&_<a;_++)i=s[_]+l,u[_]=i%n,l=i/n|0;for(l&&(u[_]=l);_<a;_++)u[_]=s[_];return new r(u,this._s,e)},r.prototype.negate=function(){return new r(this._d,0|-this._s,e)},r.prototype.abs=function(){return this._s<0?this.negate():this},r.prototype.subtract=function(t){if(0===this._s)return r(t).negate();if(0===(t=r(t))._s)return this;if(this._s!==t._s)return t=t.negate(),this.add(t);var s=this;this._s<0&&(s=new r(t._d,1,e),t=new r(this._d,1,e));var o=s.compareAbs(t);if(0===o)return i;if(o<0){var a=t;t=s,s=a}var h,u,f=s._d,l=t._d,_=f.length,p=l.length,d=new Array(_),w=0;for(h=0;h<p;h++)(u=f[h]-w-l[h])<0?(u+=n,w=1):w=0,d[h]=u;for(h=p;h<_;h++){if(!((u=f[h]-w)<0)){d[h++]=u;break}u+=n,d[h]=u}for(;h<_;h++)d[h]=f[h];return new r(d,o,e)},function(){function t(t,i){for(var s=t._d,o=s.slice(),a=0;;){var h=(s[a]||0)+1;if(o[a]=h%n,h<=n-1)break;++a}return new r(o,i,e)}function i(t,i){for(var s=t._d,o=s.slice(),a=0;;){var h=(s[a]||0)-1;if(!(h<0)){o[a]=h;break}o[a]=h+n,++a}return new r(o,i,e)}r.prototype.next=function(){switch(this._s){case 0:return s;case-1:return i(this,-1);default:return t(this,1)}},r.prototype.prev=function(){switch(this._s){case 0:return o;case-1:return t(this,-1);default:return i(this,1)}}}(),r.prototype.compareAbs=function(t){if(this===t)return 0;if(!(t instanceof r)){if(!isFinite(t))return isNaN(t)?t:-1;t=r(t)}if(0===this._s)return 0!==t._s?-1:0;if(0===t._s)return 1;var e=this._d.length,n=t._d.length;if(e<n)return-1;if(e>n)return 1;for(var i=this._d,s=t._d,o=e-1;o>=0;o--)if(i[o]!==s[o])return i[o]<s[o]?-1:1;return 0},r.prototype.compare=function(t){return this===t?0:(t=r(t),0===this._s?-t._s:this._s===t._s?this.compareAbs(t)*this._s:this._s)},r.prototype.isUnit=function(){return this===s||this===o||1===this._d.length&&1===this._d[0]},r.prototype.multiply=function(t){if(0===this._s)return i;if(0===(t=r(t))._s)return i;if(this.isUnit())return this._s<0?t.negate():t;if(t.isUnit())return t._s<0?this.negate():this;if(this===t)return this.square();var s,o=this._d.length>=t._d.length,a=(o?this:t)._d,h=(o?t:this)._d,u=a.length,f=h.length,l=u+f,_=new Array(l);for(s=0;s<l;s++)_[s]=0;for(s=0;s<f;s++){for(var p,d=0,w=h[s],g=u+s,c=s;c<g;c++)d=(p=_[c]+w*a[c-s]+d)/n|0,_[c]=p%n|0;d&&(d=(p=_[c]+d)/n|0,_[c]=p%n)}return new r(_,this._s*t._s,e)},r.prototype.multiplySingleDigit=function(t){if(0===t||0===this._s)return i;if(1===t)return this;var s;if(1===this._d.length)return new r((s=this._d[0]*t)>=n?[s%n|0,s/n|0]:[s],1,e);if(2===t)return this.add(this);if(this.isUnit())return new r([t],1,e);for(var o=this._d,a=o.length,h=a+1,u=new Array(h),f=0;f<h;f++)u[f]=0;for(var l=0,_=0;_<a;_++)l=(s=t*o[_]+l)/n|0,u[_]=s%n|0;return l&&(u[_]=l),new r(u,1,e)},r.prototype.square=function(){if(0===this._s)return i;if(this.isUnit())return s;var t,o,a,h,u=this._d,f=u.length,l=new Array(f+f+1);for(h=0;h<f;h++)a=2*h,o=(t=u[h]*u[h])/n|0,l[a]=t%n,l[a+1]=o;for(h=0;h<f;h++){o=0,a=2*h+1;for(var _=h+1;_<f;_++,a++)o=(t=u[_]*u[h]*2+l[a]+o)/n|0,l[a]=t%n;var p=o+l[a=f+h];o=p/n|0,l[a]=p%n,l[a+1]+=o}return new r(l,1,e)},r.prototype.quotient=function(t){return this.divRem(t)[0]},r.prototype.divide=r.prototype.quotient,r.prototype.remainder=function(t){return this.divRem(t)[1]},r.prototype.divRem=function(t){if(0===(t=r(t))._s)throw new Error("Divide by zero");if(0===this._s)return[i,i];if(1===t._d.length)return this.divRemSmall(t._s*t._d[0]);switch(this.compareAbs(t)){case 0:return[this._s===t._s?s:o,i];case-1:return[i,this]}for(var a,h=this._s*t._s,u=t.abs(),f=this._d,l=f.length,_=(t._d.length,[]),p=new r([],0,e);l;)if(p._d.unshift(f[--l]),(p=new r(p._d,1,e)).compareAbs(t)<0)_.push(0);else{if(0===p._s)a=0;else{var d=p._d.length,w=u._d.length,g=p._d[d-1]*n+p._d[d-2],c=u._d[w-1]*n+u._d[w-2];p._d.length>u._d.length&&(g=(g+1)*n),a=Math.ceil(g/c)}do{var v=u.multiplySingleDigit(a);if(v.compareAbs(p)<=0)break;a--}while(a);if(_.push(a),a){var y=p.subtract(v);p._d=y._d.slice()}}return[new r(_.reverse(),h,e),new r(p._d,this._s,e)]},r.prototype.divRemSmall=function(t){var s;if(0===(t=+t))throw new Error("Divide by zero");var o=t<0?-1:1,a=this._s*o;if((t=Math.abs(t))<1||t>=n)throw new Error("Argument out of range");if(0===this._s)return[i,i];if(1===t||-1===t)return[1===a?this.abs():new r(this._d,a,e),i];if(1===this._d.length){var h=new r([this._d[0]/t|0],1,e);return s=new r([this._d[0]%t|0],1,e),a<0&&(h=h.negate()),this._s<0&&(s=s.negate()),[h,s]}for(var u,f=this._d.slice(),l=new Array(f.length),_=0,p=0,d=0;f.length;){if((_=_*n+f[f.length-1])<t)l[d++]=0,f.pop(),p=n*p+_;else p=_-t*(u=0===_?0:_/t|0),l[d++]=u,u?(f.pop(),_=p):f.pop()}return s=new r([p],1,e),this._s<0&&(s=s.negate()),[new r(l.reverse(),a,e),s]},r.prototype.isEven=function(){var t=this._d;return 0===this._s||0===t.length||t[0]%2==0},r.prototype.isOdd=function(){return!this.isEven()},r.prototype.sign=function(){return this._s},r.prototype.isPositive=function(){return this._s>0},r.prototype.isNegative=function(){return this._s<0},r.prototype.isZero=function(){return 0===this._s},r.prototype.exp10=function(t){if(0===(t=+t))return this;if(Math.abs(t)>Number(a))throw new Error("exponent too large in BigInteger.exp10");if(0===this._s)return i;if(t>0){for(var n=new r(this._d.slice(),this._s,e);t>=7;t-=7)n._d.unshift(0);return 0==t?n:(n._s=1,n=n.multiplySingleDigit(Math.pow(10,t)),this._s<0?n.negate():n)}if(-t>=7*this._d.length)return i;n=new r(this._d.slice(),this._s,e);for(t=-t;t>=7;t-=7)n._d.shift();return 0==t?n:n.divRemSmall(Math.pow(10,t))[0]},r.prototype.pow=function(t){if(this.isUnit())return this._s>0?this:r(t).isOdd()?this:this.negate();if(0===(t=r(t))._s)return s;if(t._s<0){if(0===this._s)throw new Error("Divide by zero");return i}if(0===this._s)return i;if(t.isUnit())return this;if(t.compareAbs(a)>0)throw new Error("exponent too large in BigInteger.pow");for(var e=this,n=s,o=r.small[2];t.isPositive();){if(t.isOdd()&&(n=n.multiply(e),t.isUnit()))return n;e=e.square(),t=t.quotient(o)}return n},r.prototype.modPow=function(t,e){for(var n=s,i=this;t.isPositive();)t.isOdd()&&(n=n.multiply(i).remainder(e)),(t=t.quotient(r.small[2])).isPositive()&&(i=i.square().remainder(e));return n},r.prototype.log=function(){switch(this._s){case 0:return-1/0;case-1:return NaN}var t=this._d.length;if(7*t<30)return Math.log(this.valueOf());var i=Math.ceil(30/7),s=this._d.slice(t-i);return Math.log(new r(s,1,e).valueOf())+(t-i)*Math.log(n)},r.prototype.valueOf=function(){return parseInt(this.toString(),10)},r.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var a=r(2147483647);r.MAX_EXP=a,function(){function t(t){return function(e){return t.call(r(e))}}function e(t){return function(e,n){return t.call(r(e),r(n))}}function n(t){return function(e,n,i){return t.call(r(e),r(n),r(i))}}(function(){var i,s,o="toJSValue,isEven,isOdd,sign,isZero,isNegative,abs,isUnit,square,negate,isPositive,toString,next,prev,log".split(","),a="compare,remainder,divRem,subtract,add,quotient,divide,multiply,pow,compareAbs".split(","),h=["modPow"];for(i=0;i<o.length;i++)r[s=o[i]]=t(r.prototype[s]);for(i=0;i<a.length;i++)r[s=a[i]]=e(r.prototype[s]);for(i=0;i<h.length;i++)r[s=h[i]]=n(r.prototype[s]);r.exp10=function(t,e){return r(t).exp10(e)}})()}(),t.BigInteger=r})("undefined"!=typeof exports?exports:this);